 
<!-- 内容区域 -->
<div class="tpl-content-wrapper">
<div class="container-fluid am-cf">
    <div class="row">
        <div class="am-u-sm-12 am-u-md-12 am-u-lg-9">
            <div class="page-header-heading"><span class="am-icon-home page-header-heading-icon"></span> 商家管理
            <a href="<?php echo site_url().'/shop/shop/editshop';?>" style="font-size:16px;">编辑商家</a><small></small></div>
        </div>
    </div>
</div>
<div class="row-content am-cf">
    <div class="row">
        <div class="am-u-sm-12 am-u-md-12 am-u-lg-12">
            <form class="am-form" action="<?php echo site_url('/shop/shop/edit_shop_store');?>" method="post" enctype="multipart/form-data" data-am-validator>
                <div class="widget am-cf">
                    <div class="widget-head am-cf">
                        <div class="widget-title am-cf">商家基础信息</div>
                    </div>
                    <div class="widget-body  am-fr">
                        <div class="memberInfo am-u-xs-12 am-u-sm-6 am-u-md-6 am-u-lg-6 padding-horizontal-lg">
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="marketName" class="am-u-sm-3 am-form-label">商场名 <span class="red">*</span>：</label>
                                <div class="am-u-sm-8 am-u-end">
                                    <input type="text"  id="marketName"  minlength="2" value="宏帆广场" readonly required />
                                </div>
                                
                            </div>
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="username" class="am-u-sm-3 am-form-label">账户 <span class="red">*</span>：</label>
                                <div class="am-u-sm-8">
                                    <input type="hidden" name="user_id" value="<?php echo $user['user_id'];?>">
                                    <input type="text" minlength="2" maxlength="15" placeholder="请输入2-15个字符" name="username" value="<?php echo $user['username'];?>" required onblur="validate(this,2,15,1)" />
                                </div>
                                <small class="am-u-sm-1 red redtips1" style="display: none;"><i class="am-icon-close"></i></small>
                                <small class="am-u-sm-1 green blacktips1" style="display: none;"><i class="am-icon-check"></i></small>
                            </div> 
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="password" class="am-u-sm-3 am-form-label">密码 <span class="red">*</span>：</label>
                                <div class="am-u-sm-8">
                                    <input type="password" name="password" placeholder="******" onblur="validate(this,6,16,2)"  />
                                </div>
                                <small class="am-u-sm-1 red redtips2" style="display: none;"><i class="am-icon-close"></i></small>
                                <small class="am-u-sm-1 green blacktips2" style="display: none;"><i class="am-icon-check"></i></small>
                            </div>
                         
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="store_name" class="am-u-sm-3 am-form-label">商家名称 <span class="red">*</span>：</label>
                                <div class="am-u-sm-8">
                                   <input type="text" placeholder="请输入2-20个字符" minlength="2" maxlength="20" id="store_name" name="store_name" value="<?php echo $store['store_name'];?>" required onblur="validate(this,2,20,3)"  /> 
                                </div>
                                <small class="am-u-sm-1 red redtips3" style="display: none;"><i class="am-icon-close"></i></small>
                                <small class="am-u-sm-1 green blacktips3" style="display: none;"><i class="am-icon-check"></i></small>
                            </div>
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="en_name" class="am-u-sm-3 am-form-label">英文名称 ：</label>
                                <div class="am-u-sm-8 am-u-end">
                                    <input type="text" placeholder="例如：lisa" id="en_name" name="en_name" value="<?php echo $store['en_name'];?>"/>
                                </div>
                            </div>
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="open_busin" class="am-u-sm-3 am-form-label">开业时间<span class="red">*</span>：</label>
                                <div class="am-u-sm-8 am-u-end">
                                    <div class="am-input-group am-datepicker-date" data-am-datepicker="{format: 'yyyy-mm-dd', viewMode: 'years'}">
                                      <input type="text" name="open_busin" id="startBusinessTime" value="<?php echo $store['open_busin'];?>" class="am-form-field" placeholder="时间选择" readonly>
                                      <span class="am-input-group-btn am-datepicker-add-on">
                                        <button class="am-btn am-btn-secondary" type="button"><span class="am-icon-calendar"></span> </button>
                                      </span>
                                    </div>
                                </div>
                                
                            </div>
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="commercial_type_name" class="am-u-sm-3 am-form-label">一级业态<span class="red">*</span>：</label>
                                <div class="am-u-sm-8 am-u-end">
                                    <select id="commercial_type_name" name="commercial_type_name" required >
                                        <option value="">-=请选择一项=-</option>
                                        <?php foreach($yetai as $val):?>
                                        <option value="<?php echo $val['id'];?>" <?php if($val['id'] == $store['commercial_type_name']){echo "selected";}?>><?php echo $val['type_name'];?></option>
                                         <?php endforeach;?>
                                    </select>
                                </div>
                            </div>
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12" id="secondYeTai" style="display: none;">
                                <label for="subcommercial_type_name" class="am-u-sm-3 am-form-label">二级业态<span class="red">*</span>：</label>
                                <div class="am-u-sm-8 am-u-end">
                                    <select id="secondYeTaiSelect" data-id="<?php echo $store['subcommercial_type_name']?>" name="subcommercial_type_name" >
                                    <option value="">-=请选择一项=-</option>
                                    </select>
                                </div>
                            </div>
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="" class="am-u-sm-3 am-form-label">手机号<span class="red">*</span>：</label>
                                <div class="am-u-sm-8">
                                    <input type="tel"  name="phone" value="<?php echo $store['phone']?>" class="am-form-field tpl-form-no-bg" placeholder="请输入手机号" required onblur="validate(this,11,11,12)" />
                                </div>
                                <small class="am-u-sm-1 red redtips12" style="display: none;"><i class="am-icon-close"></i></small>
                                <small class="am-u-sm-1 green blacktips12" style="display: none;"><i class="am-icon-check"></i></small>
                            </div>
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="" class="am-u-sm-3 am-form-label">座机号：</label>
                                <div class="am-u-sm-8">
                                    <input type="tel"  name="tel" value="<?php echo $store['tel'];?>" class="am-form-field tpl-form-no-bg" placeholder="请输入座机号" required onblur="validate(this,7,12,13)" />
                                </div>
                                <small class="am-u-sm-1 red redtips13" style="display: none;"><i class="am-icon-close"></i></small>
                                <small class="am-u-sm-1 green blacktips13" style="display: none;"><i class="am-icon-check"></i></small>
                            </div>
                        </div>
                        <div class="memberInfo am-u-xs-12 am-u-sm-6 am-u-md-6 am-u-lg-6 padding-horizontal-lg">
                           <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="barnd_name" class="am-u-sm-3 am-form-label">经营品牌 <span class="red">*</span>：</label>
                                <div class="am-u-sm-8 am-u-end">
                                    <input type="text" placeholder="请输入2-20个字符" minlength="2" maxlength="20" id="barnd_name" name="barnd_name" value="<?php echo $store['barnd_name'];?>" onblur="validate(this,2,20,6)" />
                                </div>
                                <small class="am-u-sm-1 red redtips6" style="display: none;"><i class="am-icon-close"></i></small>
                                <small class="am-u-sm-1 green blacktips6" style="display: none;"><i class="am-icon-check"></i></small>
                            </div>
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="store_type" class="am-u-sm-3 am-form-label">商家类型 <span class="red">*</span>：</label>
                                <div class="am-u-sm-8 am-u-end">
                                    <select id="store_type" name="store_type" required onchange="validate(this,1,20,7)">
                                        <option value="">-=请选择一项=-</option>
                                        <option value="普通" <?php if($store['store_type'] == '普通'){echo "selected";}?>>普通</option>
                                        <option value="餐饮" <?php if($store['store_type'] == '餐饮'){echo "selected";}?>>餐饮</option>
                                        <option value="影院" <?php if($store['store_type'] == '影院'){echo "selected";}?>>影院</option>
                                        <option value="KTV" <?php if($store['store_type'] == 'KTV'){echo "selected";}?>>KTV</option>
                                        <option value="冰场" <?php if($store['store_type'] == '冰场'){echo "selected";}?>>冰场</option>
                                    </select>
                                    <span class="am-form-caret"></span>
                                </div>
                                <small class="am-u-sm-1 red redtips7" style="display: none;"><i class="am-icon-close"></i></small>
                                <small class="am-u-sm-1 green blacktips7" style="display: none;"><i class="am-icon-check"></i></small>
                            </div>
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="op_status" class="am-u-sm-3 am-form-label">营业状态<span class="red">*</span>：</label>
                                <div class="am-u-sm-8 am-u-end">
                                    <select id="op_status" name="op_status" required onchange="validate(this,1,20,8)">
                                        <option value="">-=请选择一项=-</option>
                                        <option value="营业中" <?php if($store['op_status'] == '营业中'){echo "selected";}?>>营业中</option>
                                        <option value="装修中" <?php if($store['op_status'] == '装修中'){echo "selected";}?>>装修中</option>
                                        <option value="停止营业" <?php if($store['op_status'] == '停止营业'){echo "selected";}?>>停止营业</option>
                                        <option value="即将营业" <?php if($store['op_status'] == '即将营业'){echo "selected";}?>>即将营业</option>
                                    </select>
                                </div>
                                <small class="am-u-sm-1 red redtips8" style="display: none;"><i class="am-icon-close"></i></small>
                                <small class="am-u-sm-1 green blacktips8" style="display: none;"><i class="am-icon-check"></i></small>
                            </div>
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="floor_name" class="am-u-sm-3 am-form-label">所在楼层 ：</label>
                                <div class="am-u-sm-8 am-u-end">
                                    <select id="floor_name" name="floor_name" >
                                         <option value="">-=请选择一项=-</option>
                                        <option value="B3" <?php if($store['floor_name'] == 'B3'){echo "selected";}?>>B3</option>
                                        <option value="B2" <?php if($store['floor_name'] == 'B2'){echo "selected";}?>>B2</option>
                                        <option value="B1" <?php if($store['floor_name'] == 'B1'){echo "selected";}?>>B1</option>
                                        <option value="F1" <?php if($store['floor_name'] == 'F1'){echo "selected";}?>>F1</option>
                                        <option value="F2" <?php if($store['floor_name'] == 'F2'){echo "selected";}?>>F2</option>
                                        <option value="F3" <?php if($store['floor_name'] == 'F3'){echo "selected";}?>>F3</option>
                                        <option value="F4" <?php if($store['floor_name'] == 'F4'){echo "selected";}?>>F4</option>
                                    </select>
                                </div>
                            </div>
                             <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="door_no" class="am-u-sm-3 am-form-label">店铺编号：</label>
                                <div class="am-u-sm-8 am-u-end">
                                    <input type="text" placeholder="例如：1001" value="<?php echo $store['door_no'];?>" name="door_no"  id="door_no" />
                                </div>
                                
                            </div>
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="business_hours" class="am-u-sm-3 am-form-label">营业时间<span class="red">*</span>：</label>
                                <div class="am-u-sm-8 am-u-end">
                                    <input type="text" placeholder="例如：9:20-22:00" minlength="2" maxlength="15" name="business_hours" value="<?php echo $store['business_hours'];?>"  id="business_hours" required onblur="validate(this,2,13,9)" />
                                </div>
                                <small class="am-u-sm-1 red redtips9" style="display: none;"><i class="am-icon-close"></i></small>
                                <small class="am-u-sm-1 green blacktips9" style="display: none;"><i class="am-icon-check"></i></small>
                            </div>
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="area" class="am-u-sm-3 am-form-label">面积/平方米：</label>
                                <div class="am-u-sm-8 am-u-end">
                                    <input type="number" placeholder="例如：100.00" name="area" value="<?php echo $store['area'];?>" id="area" />
                                </div>
                            </div>
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label for="area" class="am-u-sm-3 am-form-label">QQ：</label>
                                <div class="am-u-sm-8 am-u-end">
                                    <input type="number" placeholder="请输入QQ" name="qq" value="<?php echo $store['qq'];?>" id="area" />
                                </div>
                            </div>
                            <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                                <label class="am-u-sm-3 am-form-label" data-am-popover="{content: '开启口令验证，用户可以在商场用口令自助验证券', trigger: 'hover focus'}">是否开启核销口令:</label>
                                <div class="am-u-sm-8 am-u-end">
                                    <label class="am-radio-inline">
                                        <input type="radio" value="1" <?php if($store['verification'] == '1'){echo "checked";}?> name="verification"> 是
                                    </label>
                                    <label class="am-checkbox-inline">
                                        <input type="radio" value="0" <?php if($store['verification'] == '0'){echo "checked";}?> name="verification"> 否
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="am-form-group am-text-center">
                        <input type="hidden" name="store_id" value="<?php echo $store['store_id'];?>">
                        <input type="hidden" name="store_distinction" value="<?php echo $store['store_distinction'];?>">
                        <button class="am-btn am-btn-default" id="cancle" type="reset">取消</button> <button class="am-btn am-btn-secondary" type="submit">提交</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
</div>
<div class="goTop"><a href="javascript:scroll(0,0)" type="button"><img src="assets/img/top.png" alt="点我回到顶部"></a></div>

<script type="text/javascript">

//表单验证函数
function validate(obj,minlen,maxlen,i){
    var content=obj.value;
    if(content.length<minlen || content.length>maxlen){
        $('.blacktips'+ i).css('display','none');
        $('.redtips'+ i).css('display','inline-block');
    }else{
        $('.redtips'+ i).css('display','none');
        $('.blacktips'+ i).css('display','inline-block');
    }
}

  $(function() {
    var startDate = new Date(2014, 11, 20);
    var endDate = new Date(2014, 11, 25);
    var $alert = $('#my-alert');
    $('#my-start').datepicker().
      on('changeDate.datepicker.amui', function(event) {
        if (event.date.valueOf() > endDate.valueOf()) {
          $alert.find('p').text('开始日期应小于结束日期！').end().show();
        } else {
          $alert.hide();
          startDate = new Date(event.date);
          $('#my-startDate').text($('#my-start').data('date'));
        }
        $(this).datepicker('close');
      });

    $('#my-end').datepicker().
      on('changeDate.datepicker.amui', function(event) {
        if (event.date.valueOf() < startDate.valueOf()) {
          $alert.find('p').text('结束日期应大于开始日期！').end().show();
        } else {
          $alert.hide();
          endDate = new Date(event.date);
          $('#my-endDate').text($('#my-end').data('date'));
        }
        $(this).datepicker('close');
      });


      //根据一级业态的内容来控制二级业态的显示
        var commercial_type_name=$('#commercial_type_name option:selected').val(),str='',sttr='';
        var secondDefault = $("#secondYeTaiSelect").attr('data-id');
        $("#secondYeTaiSelect").html('<option value="">-=请选择一项=-</option>');
        $.ajax({
            type:'post',
            url:'<?php echo site_url('/shop/singleShop/shop_store_type');?>',
            data: 'gid='+ commercial_type_name,
            success: function(data){   
                var jsonData=eval(data);
                console.log(jsonData);
                if(jsonData){
                    if(jsonData==2){
                           $('#secondYeTai').css('display','none');
                           $("#secondYeTaiSelect").removeAttr("required"); 
                    } else {
                        for(var i=0;i<jsonData.length;i++){
                            if(jsonData[i].id==secondDefault){

                                str='<option selected value="'+ jsonData[i].id +'">' + jsonData[i].type_name + '</option>';
                            }else{
                                str='<option value="'+ jsonData[i].id +'">' + jsonData[i].type_name + '</option>';
                            }
                            
                            sttr=sttr+str;
                        }
                        $('#secondYeTai').css('display','block');
                        $("#secondYetaiSelect").attr("required","required"); 
                        $("#secondYeTaiSelect").append(sttr);
                    }
                    
                }else{
                    $('#secondYetai').css('display','none');
                    $("#secondYetaiSelect").removeAttr("required");
                }
                
            },
            error:function(xhr,type,errorThrown){
                alert("操作失败，请检查网络设置！");
            }
        });
  });


      $('#commercial_type_name').change(function(){
        //根据一级业态的内容来控制二级业态的显示
        var commercial_type_name=$('#commercial_type_name option:selected').val(),str='',sttr='';
        $("#secondYeTaiSelect").html('<option value="">-=请选择一项=-</option>');
        $.ajax({
            type:'post',
            url:'<?php echo site_url('/shop/singleShop/shop_store_type');?>',
            data: 'gid='+ commercial_type_name,
            success: function(data){   
                var jsonData=eval(data);
                // console.log(jsonData);
                if(jsonData){
                    if(jsonData==2){
                           $('#secondYeTai').css('display','none');
                           $("#secondYeTaiSelect").removeAttr("required"); 
                    } else {
                        for(var i=0;i<jsonData.length;i++){
                            str='<option value="'+ jsonData[i].id +'">' + jsonData[i].type_name + '</option>';
                            sttr=sttr+str;
                        }
                        // console.log(sttr);
                        $('#secondYeTai').css('display','block');
                        $("#secondYetaiSelect").attr("required","required"); 
                        $("#secondYeTaiSelect").append(sttr);
                    }
                    
                }else{
                    $('#secondYetai').css('display','none');
                    $("#secondYetaiSelect").removeAttr("required");
                }
                
            },
            error:function(xhr,type,errorThrown){
                alert("操作失败，请检查网络设置！");
            }
        });
    });

    //点击取消返回上一页
  $('#cancle').click(function(){
    history.go(0);
  });
</script>
