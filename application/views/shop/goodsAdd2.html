 
<style type="text/css">
  #preview{
        width:150px !important;
    }
    #preview #imghead,#preview img{
     width:140px !important;
    }
    .widget{
        font-color:#000 !;
    }  
  
    .postageNumber{
        display: none;
    } 
     
    .addStyle{
        display: inline-block;
        padding: 3px 5px;
        border: 1px solid #1fb5ac;
        color: #1fb5ac;
        margin-left: 10px;
    }
    .addStyle:hover{
        cursor: pointer;
    }
    table tbody tr td,table thead tr th{
        font-weight: normal;
    }
    .addPropertyContent{
        margin-left: 80px;
    }
    table tbody tr{
        margin: 20px 0 !important;
    }
    .am-modal-dialog {
        width: 414px;
        height: 750px;
        overflow-y: scroll;
    }
    .bannerPic{
        width: 100%;
    }
    .good-price{
        color: #f43A44;
        font-size: 20px;
    }
    .shoplogo{
        width: 30px;
    }
    .small-word{
        color: #999;
        font-size: 14px;
        margin-top: 0;
        margin-bottom: 0;
    }
    .big-word{
        font-size: 20px;
        margin-left: -10px;
    }
    .big-word1{
        font-size: 20px;
    }
    .smallsize{
        font-size: 14px;
    }

    .good-detail{
        padding-left: 20px !important;
        padding-bottom: 10px;
    }
    .good-bd {
        border-bottom: none;
    }
    .addpadding{
        padding-top: 1.0rem;
    }
    #goodsBanner{
        position: relative;
        width: 100% !important;
        padding-top: 100%;
    }
    #goodsBanner img{
        position: absolute;
        top:0;left:0;
        width:100% !important;
        height: 100% !important;
    }
    .badgeTips{
        display: inline-block;
        padding:2px 10px !important;
        border-radius: 8px;
        background: #e0e0e0;
        font-size: 14px;
        margin-right: 10px;
    }
    #showgoodsDetail img{
        width:100%;
    }
    td input{
    padding:0 !important;
}
</style>

<!-- 内容区域 -->
<div class="tpl-content-wrapper">
<div class="container-fluid am-cf">
    <div class="row">
        <div class="am-u-sm-12 am-u-md-12 am-u-lg-9">
            <div class="page-header-heading"><span class="am-icon-home page-header-heading-icon"></span>商家管理
            <a href="<?php echo site_url().'/shop/singleShop/goodsList';?>">商品列表</a> <small>/新增商品</small></div>
        </div>
    </div>
</div>
<div class="row-content am-cf">
    <div class="row">
        <div class="am-u-sm-12 am-u-md-12 am-u-lg-12">
            <form class="am-form" action="<?php echo site_url('/shop/singleShop/add_goods');?>" method="post" enctype="multipart/form-data" data-am-validator>
                <div class="widget am-cf">
                    <div class="widget-head am-cf">
                        <div class="widget-title  am-cf">商品基础信息</div>
                    </div>
                    <div class="widget-body  am-fr">
                    <div class="memberInfo am-u-xs-12 am-u-sm-6 am-u-md-6 am-u-lg-6 padding-horizontal-lg">                                        
                        <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                            <label for="goodName" class="am-u-sm-3 am-form-label">商品名称<span class="red">*</span>：</label>
                            <div class="am-u-sm-8">
                                <input type="text" id="goodName" name='title' required="required" onblur="validate(this,2,50,1)" />  
                            </div>
                            <small class="am-u-sm-1 red redtips1" style="display: none;"><i class="am-icon-close"></i></small>
                            <small class="am-u-sm-1 green blacktips1" style="display: none;"><i class="am-icon-check"></i></small>
                        </div>
                        
                        <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                            <label for="goodPrice" class="am-u-sm-3 am-form-label">商品价格<span class="red">*</span>：</label>
                            <div class="am-u-sm-8">
                                <input type="number" class="am-u-xs-12 am-u-sm-6 am-u-md-6 am-u-lg-6" id="goodPrice" name="price" required="required" min="1" onblur="validate(this,2,20,2)" /> 
                            </div>
                            <small class="am-u-sm-1 red redtips2" style="display: none;"><i class="am-icon-close"></i></small>
                            <small class="am-u-sm-1 green blacktips2" style="display: none;"><i class="am-icon-check"></i></small>
                        </div>
                         
                        <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                            <label for="goodBrand" class="am-u-sm-3 am-form-label">商品品牌：</label>
                            <div class="am-u-sm-8 am-u-end">
                                <input type="text" name='brand' id="goodBrand"  />
                            </div>
                            
                        </div>
                        
                        <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                            <label for="englishName" class="am-u-sm-3 am-form-label">添加属性：</label>
                            <div class="am-u-sm-9 tableContainer">
                                <table class="addProperty">
                                <thead>
                                    <th>属性名称</th>
                                    <th>&nbsp;</th>
                                </thead>
                                <tbody class="addPropertyBody">
                                    <td class="propertyName"><input type="text"></td>
                                    <td><i class="am-icon am-icon-plus addStyle createMoreName"></i></td>
                                    <table class="addPropertyContent">
                                        <thead>
                                            <th>属性值</th>
                                            <th>附加值</th>
                                            <th>库存</th>
                                            <th>&nbsp;</th>
                                        </thead>
                                        <tbody class="addPropertyTr">
                                            <tr class="addPropertytr">
                                                <td class="propertyValue"><input type="text" ></td>
                                                <td class="propertyValue"><input type="text"></td>
                                                <td class="propertyValue"><input type="text" ></td>
                                                <td class="propertyValue"><i class="am-icon am-icon-plus addStyle createMore1"></i></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </tbody>
                            </table>
                           <input type="hidden" name="parameter" id='inputproperty'>
                            </div>
                        </div>
                        <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12" >
                            <label for="oneType" class="am-u-sm-3 am-form-label">是否包邮<span class="red">*</span>：</label>
                            <div class="am-u-sm-8 am-u-end"><input type="radio" name="cod" value="1" id="dispostage" />是
                            <input type="radio" name="cod" id="postage" value="0"/>否</div>
                            
                        </div>
                        <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12 postageNumber" >
                            <label for="englishName" class="am-u-sm-3 am-form-label">请输入运费<span class="red">*</span>：</label>
                            <div class="am-u-sm-8"><input type="number"  id="postageNum" name="postage" min="1" onblur="validate(this,2,10,3)" /></div>
                            <small class="am-u-sm-1 red redtips3" style="display: none;"><i class="am-icon-close"></i></small>
                            <small class="am-u-sm-1 green blacktips3" style="display: none;"><i class="am-icon-check"></i></small>
                        </div>
                       <!--  <div class="am-form-group">
                            <label for="oneType">货到付款：</label>
                            <select id="oneType" required="required" name="cod">
                                <option value="">-=请选择一项=-</option>
                                <option value="1">支持货到付款</option>
                                <option value="0">不支持货到付款</option>
                            </select>
                        </div> -->
                        
                    </div>
                    <div class="memberInfo am-u-xs-12 am-u-sm-6 am-u-md-6 am-u-lg-6 padding-horizontal-lg">
                    <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                        <label class="am-u-sm-3 am-form-label">商品一级分类<span class="red">*</span>：</label>
                        <div class="am-u-sm-8 am-u-end">
                            <select id="firstSort" required="required" data-am-selected="{searchBox: 1,maxHeight: 300}" name='categoryid'>
                                <option value=''>请选择一个！</option>
                                <?php foreach($cates as $val):?>
                                <option value="<?php echo $val['catid'];?>"><?php echo $val['catname'];?></option>
                                <?php endforeach;?>
                            </select>
                        </div>
                    </div>
                    <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12" id="secondSort" style="display: none;">
                        <label class="am-u-sm-3 am-form-label">商品二级分类<span class="red">*</span>：</label>
                        <div class="am-u-sm-8 am-u-end">
                            <select id="secondSortSelect" required="required" data-am-selected="{searchBox: 1,maxHeight: 200}" name='soncategoryid'>
                            
                            </select>
                        </div>
                    </div>
                      <!--   <div class="am-form-group"> 
                            <label for="oneType">是否是推荐产品<span class="red">*</span>：</label>
                            <input type="radio" name="recommend" value="1"/>是
                            <input type="radio" name="recommend" value="0"/>否
                        </div> -->
                        <input type="hidden"  id="respority" name="amount" min="1" required="required" />    
                           
                     <!--    <?php if($this->session->users['gid'] != 2):?>
                        <div class="am-form-group">
                            <label for="englishName">审核状态：<span class="red">*</span>：</label>
                            <select id="oneType" required="required" name='auditing_state'>
                                <option value="">-=请选择一项=-</option>
                                <option value="1">通过审核</option>
                                <option value="0">待审核</option>
                                <option value="2">未通过</option>
                            </select>

                        </div> 
                        <?php endif;?> -->
                        <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                            <label for="englishName" class="am-u-sm-3 am-form-label">商品状态：<span class="red">*</span>：</label>
                            <div class="am-u-sm-9">
                                <input type="radio" name="goods_state" value="1"/>上架
                                <input type="radio" name="goods_state" value="0"/>下架
                            </div>
                        </div>
                        <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                            <label for="user-weibo" class="am-u-sm-3 am-form-label am-u-end">商品图片：</label>
                            <div class="am-u-sm-12">
                                <div class="am-u-sm-4">
                                    <div class="wx_type_img">
                                     <input type="file" id="imgUpload" name="img1" onchange="previewImage1(this)" class="upload-add" multiple="multiple" required>
                                      <!-- 图片实时预览 -->
                                      <div id="preview"> <img style="border-radius: 3px;" src="assets/img/nullImg.jpg" class="am-img-responsive cardView firstBanner"> </div>
                                    </div>
                                    <span class="deleteImg"><i class="am-icon-trash"></i> 删除</span> 
                                </div>
                                <div class="am-u-sm-4">
                                    <div class="wx_type_img">
                                     <input type="file" id="imgUpload" name="img2" onchange="previewImage(this)" class="upload-add" multiple="multiple">
                                      <!-- 图片实时预览 -->
                                      <div id="preview"> <img style="border-radius: 3px;" src="assets/img/nullImg.jpg" class="am-img-responsive cardView"> </div>
                                    </div>
                                    <span class="deleteImg"><i class="am-icon-trash"></i> 删除</span> 
                                </div>
                                <div class="am-u-sm-4">
                                    <div class="wx_type_img">
                                     <input type="file" id="imgUpload" name="img3" onchange="previewImage(this)" class="upload-add" multiple="multiple">
                                      <!-- 图片实时预览 -->
                                      <div id="preview"> <img style="border-radius: 3px;" src="assets/img/nullImg.jpg" class="am-img-responsive cardView"> </div>
                                    </div>
                                    <span class="deleteImg"><i class="am-icon-trash"></i> 删除</span> 
                                </div>
                            </div>
                            <div class="red am-text-center father">              
                              <small class="tpl-form-line-small-title">提示：图片格式支持：PNG、JPG、JPEG；不超过三张，最大支持2M</small> 
                          </div> 
                        </div>
                        
                    </div>
                    <div class="memberInfo am-u-xs-12 am-u-sm-12 am-u-md-12 am-u-lg-12 padding-horizontal-lg"> 
                        <div class="am-form-group am-u-sm-12 am-u-md-12 am-u-lg-12">
                            <label for="englishName" class="am-u-sm-1 am-form-label">商品详情<span class="red">*</span>：</label>
                            <div class="am-u-sm-10 am-u-end">
                                <div id="editorContent">
                                    <textarea id="editor" type="text/plain" name='content'></textarea>
                                </div>  
                            </div>                
                        </div>
                    </div>
                </div>

                    <div class="am-form-group am-text-center">
                        <a data-am-modal="{target: '#goodMessage'}" id="eyeDetail" class="am-btn am-btn-default am-btn-warning"><span class="am-icon-eye"></span> 点击预览</a>
                        <button class="am-btn am-btn-secondary" type="submit" id='addProperty'>提交</button>
                        <button class="am-btn am-btn-default" type="reset" id="cancle">取消</button> 
                    </div>

                </div>
            </form>
        </div>
    </div>
</div>
</div>
<!-- 预览开始 -->
<div class="am-modal am-modal-prompt" tabindex="-1" id="goodMessage">
    <div class="am-modal-dialog">
        <div class="am-modal-hd">移动端商品预览(仅展示)</div>
        <div class="am-modal-bd good-bd">
            <div class="goodBanner" id="goodsBanner">
                
            </div>
            <div class="goodBanner am-u-lg-12 am-u-sm-12 am-u-md-12 am-text-left addpadding">
                <div class="am-u-lg-10 am-u-sm-10 am-u-md-10" id="showgoodsname">leica/徕卡 SOFORT相机 一次成像立拍立得相机 限量出售</div>
                <div class="am-u-lg-2 am-u-sm-2 am-u-md-2 am-text-center" style="border-left: 1px solid #ccc;">
                    <img src="assets/img/shangjia.png" class="shoplogo" />
                    <p class="small-word">商家</p>
                </div>
            </div>
            <div class="goodBanner am-u-lg-12 am-u-sm-12 am-u-md-12 am-text-left good-price">
                <div class="am-u-lg-4 am-u-sm-4 am-u-md-4" id="showgoodsprice">￥ 2299</div>
            </div>
            <div class="goodBanner am-u-lg-12 am-u-sm-12 am-u-md-12 am-text-left">
                <div class="am-u-lg-4 am-u-sm-4 am-u-md-4 small-word" id="showgoodspostage">快递：免邮</div>
                <div class="am-u-lg-4 am-u-sm-4 am-u-md-4 small-word">
                    销量：21笔
                </div>
                <div class="am-u-lg-4 am-u-sm-4 am-u-md-4 small-word" id="showgoodsresporty">
                    库存：100件
                </div>
            </div>
            <div id="showproporty" class="am-u-lg-12 am-u-sm-12 am-u-md-12 am-text-left">
                
            </div>
            <div class="goodBanner am-u-lg-12 am-u-sm-12 am-u-md-12 am-text-left good-detail">
                <p class="big-word">商品详情</p>
                <article class="smallsize" id="showgoodsDetail">
                    它融合了徕卡的独特设计专属功能，令我们重新发现即影即有的摄影世界，创造出可以触摸到的小小艺术品。
                </article>
            </div>
        </div>
        <div class="am-modal-footer">
            <button type="button" class="am-modal-btn" data-am-modal-confirm>确定</button>
        </div>
    </div>
</div>
<!-- 预览结束 -->
<!-- 设置运费弹出框开始 -->
<div class="am-modal am-modal-prompt" tabindex="-1" id="myModal">
    <div class="am-modal-dialog">
        <div class="am-modal-hd">请输入运费</div>
        <div class="am-modal-bd">
            <input type="number" class="am-modal-prompt-input" name="" required>
        </div>
        <div class="am-modal-footer">
            <span class="am-modal-btn" data-am-modal-cancle>取消</span>
            <span class="am-modal-btn" data-am-modal-confirm>确定</span>
        </div>
    </div>
</div>
<div class="goTop"><a href="javascript:scroll(0,0)" type="button"><img src="assets/img/top.png" alt="点我回到顶部"></a></div>
<!-- 设置运费弹出框结束 -->
<script type="text/javascript" charset="utf-8" src="assets/ueditor/ueditor.config.js"></script>
    <script type="text/javascript" charset="utf-8" src="assets/ueditor/ueditor.all.min.js"> </script>
    <!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
    <!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
    <script type="text/javascript" charset="utf-8" src="assets/ueditor/lang/zh-cn/zh-cn.js"></script>
</body>
<script type="text/javascript">
//表单验证函数
function validate(obj,minlen,maxlen,i){
    var content=obj.value;
    if(content.length<minlen || content.length>maxlen){
        $('.blacktips'+ i).css('display','none');
        $('.redtips'+ i).css('display','inline-block');
    }else{
        $('.redtips'+ i).css('display','none');
        $('.blacktips'+ i).css('display','inline-block');
    }
}

  $(function() {
      var startDate = new Date(2014, 11, 20);
      var endDate = new Date(2014, 11, 25);
      var $alert = $('#my-alert');
      $('#my-start').datepicker().on('changeDate.datepicker.amui', function(event) {
        if (event.date.valueOf() > endDate.valueOf()) {
          $alert.find('p').text('开始日期应小于结束日期！').end().show();
        } else {
          $alert.hide();
          startDate = new Date(event.date);
          $('#my-startDate').text($('#my-start').data('date'));
        }
        $(this).datepicker('close');
      });

      $('#my-end').datepicker().on('changeDate.datepicker.amui', function(event) {
        if (event.date.valueOf() < startDate.valueOf()) {
          $alert.find('p').text('结束日期应大于开始日期！').end().show();
        } else {
          $alert.hide();
          endDate = new Date(event.date);
          $('#my-endDate').text($('#my-end').data('date'));
        }
        $(this).datepicker('close');
      });

      //点击预览商品详情
      $('#eyeDetail').click(function() {
        var propertyArray=[],totalrespority=0;
        for(var i=0;i<$('.addPropertyBody').length;i++){
            var arrayPropertyName={},addPropertyBody={};
            var parameter_name=$('.addPropertyBody').eq(i).find('input').val();
            arrayPropertyName.parameter_name=parameter_name;    
            arrayPropertyName.child_value=[];
            var addPropertytr=$('.addPropertyContent').eq(i).find('.addPropertytr')
            for(var j=0;j<addPropertytr.length;j++){
                var td=addPropertytr.eq(j).find('td');
                var addPropertytd={};
                addPropertytd.parameter_name=parameter_name;
                addPropertytd.child_parameter_name=td.eq('0').find('input').val();
                addPropertytd.equivalence=td.eq('1').find('input').val();
                addPropertytd.Inventory=td.eq('2').find('input').val();
                totalrespority+=parseInt(addPropertytd.Inventory);
                arrayPropertyName.child_value.push(addPropertytd);
            }
            propertyArray.push(arrayPropertyName);
        }
        // console.log(propertyArray);
        var html = template("showproportyModal",{propertyArray:propertyArray});
        document.getElementById('showproporty').innerHTML = html;

        var picSrc=$('#goodsBanner').html();
        var goodName=$('#goodName').val();
        var goodPrice=$('#goodPrice').val();
        var postage=document.getElementById('dispostage').checked,postageNum=$('#postageNum').val();
        var dispostage=$('#dispostage').attr('checked');
        var editorContent= UE.getEditor('editor').getContent();
        $('#showgoodsname').html(goodName);
        $('#showgoodsprice').html('￥'+goodPrice);
        $('#showgoodsresporty').html('库存：'+totalrespority);
        if(postage){
            $('#showgoodspostage').html("快递：免邮");
        }else{
            $('#showgoodspostage').html("运费："+ postageNum +"元");
        }
        $('#showgoodsDetail').html(editorContent);

      });
      
  });
//点击取消返回上一页
  $('#cancle').click(function(){
    history.go(-1);
  });

  //点击进行运费设置
$('#postage').click(function(){
    $('.postageNumber').css('display','block');

});
//点击取消运费设置
$('#dispostage').click(function(){
    $('.postageNumber').css('display','none');
});

 //删除图片
$(".deleteImg").click(function(){
    $(this).siblings('.wx_type_img').find('img').attr('src','assets/img/nullImg.jpg');
    $(this).siblings('.wx_type_img').find('input').val("");
    $(this).siblings('.wx_type_img').find('input').files="";
});
var i=1;
  
//实例化编辑器
  var ue = UE.getEditor('editor');

 //添加属性名称的设置
    $('.createMoreName').click(function(){   
        i++;
        $('<table class="addProperty"><thead><th>属性名称</th><th>&nbsp;</th></thead><tbody class="addPropertyBody"><td class="propertyName"><input type="text" ></td><td>&nbsp;</i></td><table class="addPropertyContent"><thead><th>属性值</th><th>附加值</th><th>&nbsp;</th></thead><tbody class="addPropertyTr"><tr class="addPropertytr"><td class="propertyValue"><input type="text" ></td><td class="propertyValue"><input type="text" ></td><td class="propertyValue"><input type="text" ></td><td class="propertyValue"><i class="am-icon am-icon-plus addStyle createMore'+ i +'"></i></td></tr></tbody></table></tbody></table>').appendTo('.tableContainer');
        //添加属性值的设置

        $('.createMore'+i).click(function(){
           $('<tr class="addPropertytr"><td><input type="text" ></td><td><input type="text" ></td><td><input type="text" ></td></tr>').appendTo(this.parentNode.parentNode.parentNode);
        });    
    })
    //添加属性值的设置
    $('.createMore1').click(function(){
       $('<tr class="addPropertytr"><td><input type="text" ></td><td><input type="text" ></td><td><input type="text" ></td></tr>').appendTo(this.parentNode.parentNode.parentNode);
    });

    //添加属性
    $('#addProperty').click(function(){
        var propertyArray=[],totalrespority=0;
        for(var i=0;i<$('.addPropertyBody').length;i++){
            var arrayPropertyName={},addPropertyBody={};
            var parameter_name=$('.addPropertyBody').eq(i).find('input').val();
            arrayPropertyName.parameter_name=parameter_name;    
            arrayPropertyName.child_value=[];
            var addPropertytr=$('.addPropertyContent').eq(i).find('.addPropertytr')
            for(var j=0;j<addPropertytr.length;j++){
                var td=addPropertytr.eq(j).find('td');
                var addPropertytd={};
                addPropertytd.parameter_name=parameter_name;
                addPropertytd.child_parameter_name=td.eq('0').find('input').val();
                addPropertytd.equivalence=td.eq('1').find('input').val();
                addPropertytd.Inventory=td.eq('2').find('input').val();
                totalrespority+=parseInt(addPropertytd.Inventory);
                arrayPropertyName.child_value.push(addPropertytd);
            }
            propertyArray.push(arrayPropertyName);
        }
        $("#inputproperty").val(JSON.stringify(propertyArray));
        $('#respority').val(totalrespority);
       // console.log(JSON.stringify(propertyArray));
    });

    $(document).ready(function(){
        //根据一级业态的内容来控制二级业态的显示

         $('#firstSort').change(function(){
            //根据一级业态的内容来控制二级业态的显示
            var firstSort=$('#firstSort option:selected').val(),str='',sttr='<option value="">请选择一项...</option>';
            $.ajax({
                type:'post',
                url:'<?php echo site_url('shop/SingleShop/return_godos_cate');?>',
                data: 'catid='+ firstSort,
                success: function(data){ 
                    $("#secondSortSelect").html("");  
                    var jsonData=eval(data);
                    console.log(jsonData);
                    if(data!=2){                
                        for(var i=0;i<jsonData.length;i++){
                            str='<option value="'+ jsonData[i].catid +'">' + jsonData[i].catname + '</option>';
                            sttr=sttr+str;
                        }
                        console.log(sttr);

                        $('#secondSort').css('display','block');
                        $("#secondSortSelect").attr('required');
                        $("#secondSortSelect").append(sttr);
                    }else{
                        $("#secondSortSelect").removeAttr('required');
                    }
                    
                },
                error:function(xhr,type,errorThrown){
                    alert("操作失败，请检查网络设置！");
                }
            });
        });
    });

//图片预览的商品图片
function previewImage1(file) {
  var MAXWIDTH = 350;
  var MAXHEIGHT = 249;
  //var div = document.getElementById('preview');
  var div = findPreview(file.parentNode);
  var div1 = document.getElementById('goodsBanner');
  if (file.files && file.files[0]) {
    div.innerHTML = '<img id=imghead>';
    div1.innerHTML = '<img >';
    //var img = document.getElementById('imghead');
    var img = div.lastChild,img1=div1.lastChild;
    img.onload = function() {
      var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
      img.width = rect.width;
      img.height = rect.height;
    }
    img1.onload = function() {
      var rect1 = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
      img1.width = rect1.width;
      img1.height = rect1.height;
    }
    var reader = new FileReader();
    reader.onload = function(evt) {
      img.src = evt.target.result;
      img1.src = evt.target.result;
    }
    
    reader.readAsDataURL(file.files[0]);
  } else //鍏煎IE
  {
    //alert("123");
    var sFilter = 'filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src="';
    file.select();
    var src = document.selection.createRange().text;
    div.innerHTML = '<img id=imghead>';
    div1.innerHTML = '<img id=imghead>';
    //var img = document.getElementById('imghead');
    var img = div.lastChild;
    img.filters.item('DXImageTransform.Microsoft.AlphaImageLoader').src = src;
    var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
    status = ('rect:' + rect.top + ',' + rect.left + ',' + rect.width + ',' + rect.height);
    var img1 = div1.lastChild;
    img1.filters.item('DXImageTransform.Microsoft.AlphaImageLoader').src = src;
    var rect1 = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img1.offsetWidth, img1.offsetHeight);
    status1 = ('rect:' + rect1.top + ',' + rect1.left + ',' + rect1.width + ',' + rect1.height);
    div.innerHTML = "<div id=divhead style='width:" + rect.width + "px;height:" + rect.height + "px;margin-top:" + rect.top + "px;" + sFilter + src + "\"'></div>";
    div1.innerHTML = "<div id=divhead style='width:" + rect1.width + "px;height:" + rect1.height + "px;margin-top:" + rect1.top + "px;" + sFilter + src + "\"'></div>";
  }
}


</script>
<script type="text/html" id="showproportyModal">
<%for(var i=0;i<propertyArray.length;i++) {%>
    <div>
        <p class="big-word1"><%= propertyArray[i].parameter_name%></p>
        <p>
        <%for(var j=0;j<propertyArray[i].child_value.length;j++) {%>
            <span class="badgeTips"><%= propertyArray[i].child_value[j].child_parameter_name%></span>
        <%}%>
        </p>
    </div>
<%}%>
</script>
