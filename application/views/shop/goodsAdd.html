 
<style type="text/css">
  #preview{
        width:150px !important;
    }
    #preview #imghead,#preview img{
     width:140px !important;
    }
    .widget{
        font-color:#000 !;
    }  
 
    .postageNumber{
        display: none;
    }
   
    .addStyle{
        display: inline-block;
        padding: 3px 5px;
        border: 1px solid #1fb5ac;
        color: #1fb5ac;
        margin-left: 10px;
    }
    .addStyle:hover{
        cursor: pointer;
    }
    table tbody tr td,table thead tr th{
        font-weight: normal;
    }
    .addPropertyContent{
        margin-left: 80px;
    }
    table tbody tr{
        margin: 20px 0 !important;
    }
    .am-modal-dialog {
        width: 414px;
        height: 750px;
        overflow-y: scroll;
    }
    .bannerPic{
        width: 100%;
    }
    .good-price{
        color: #f43A44;
        font-size: 20px;
    }
    .shoplogo{
        width: 30px;
    }
    .small-word{
        color: #999;
        font-size: 14px;
        margin-top: 0;
        margin-bottom: 0;
    }
    .big-word{
        font-size: 20px;
    }
    .smallsize{
        font-size: 14px;
    }

    .good-detail{
        padding-left: 20px !important;
        padding-bottom: 10px;
    }
    .good-bd {
        border-bottom: none;
    }
    .addpadding{
        padding-top: 1.0rem;
    }
    article{
        text-indent: 2em;
    }
</style>

<!-- 内容区域 -->
<div class="tpl-content-wrapper">
<div class="container-fluid am-cf">
    <div class="row">
        <div class="am-u-sm-12 am-u-md-12 am-u-lg-9">
            <div class="page-header-heading"><span class="am-icon-home page-header-heading-icon"></span>商家管理
            <a href="<?php echo site_url().'/shop/singleShop/goodsList';?>">商品列表</a> <small>/新增商品</small></div>
        </div>
    </div>
</div>
<div class="row-content am-cf">
    <div class="row">
        <div class="am-u-sm-12 am-u-md-12 am-u-lg-12">
            <form class="am-form" action="<?php echo site_url('/shop/singleShop/add_goods');?>" method="post" enctype="multipart/form-data">
                <div class="widget am-cf">
                    <div class="widget-head am-cf">
                        <div class="widget-title  am-cf">商品基础信息</div>
                    </div>
                    <div class="widget-body  am-fr">
                    <div class="memberInfo am-u-xs-12 am-u-sm-6 am-u-md-6 am-u-lg-6 padding-horizontal-lg">                                        
                        <div class="am-form-group">
                            <label for="goodName">商品名称<span class="red">*</span>：</label>
                            <input type="text" id="goodName" name='title' required="required" />
                        </div>
                        
                        <div class="am-form-group">
                            <label for="goodPrice">商品价格<span class="red">*</span>：</label>
                             <input type="number" class="am-u-xs-12 am-u-sm-6 am-u-md-6 am-u-lg-6" id="goodPrice" name="price" required="required" />
                        </div>
                         
                        <div class="am-form-group">
                            <label for="goodBrand">商品品牌：</label>
                            <input type="text" name='brand' id="goodBrand"  />
                        </div>
                        
                        <div class="am-form-group">
                            <label for="englishName">添加属性：</label>
                            <div class="tableContainer">
                                <table class="addProperty">
                                <thead>
                                    <th>属性名称</th>
                                    <th>&nbsp;</th>
                                </thead>
                                <tbody class="addPropertyBody">
                                    <td class="propertyName"><input type="text"></td>
                                    <td><i class="am-icon am-icon-plus addStyle createMoreName"></i></td>
                                    <table class="addPropertyContent">
                                        <thead>
                                            <th>属性值</th>
                                            <th>附加值</th>
                                            <th>库存</th>
                                            <th>&nbsp;</th>
                                        </thead>
                                        <tbody class="addPropertyTr">
                                            <tr class="addPropertytr">
                                                <td class="propertyValue"><input type="text" ></td>
                                                <td class="propertyValue"><input type="text"></td>
                                                <td class="propertyValue"><input type="text" ></td>
                                                <td class="propertyValue"><i class="am-icon am-icon-plus addStyle createMore1"></i></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </tbody>
                            </table>
                           <input type="hidden" name="parameter" id='inputproperty'>
                            </div>
                        </div>
                        <div class="am-form-group" >
                            <label for="oneType">是否包邮：</label>
                            <input type="radio" name="cod" value="1" id="dispostage" />是
                            <input type="radio" name="cod" id="postage" value="0"/>否
                        </div>
                        <div class="am-form-group postageNumber" >
                            <label for="englishName">请输入运费<span class="red">*</span>：</label>
                            <input type="number"  id="postageNum" name="postage"  />
                        </div>
                       <!--  <div class="am-form-group">
                            <label for="oneType">货到付款：</label>
                            <select id="oneType" required="required" name="cod">
                                <option value="">-=请选择一项=-</option>
                                <option value="1">支持货到付款</option>
                                <option value="0">不支持货到付款</option>
                            </select>
                        </div> -->
                        
                    </div>
                    <div class="memberInfo am-u-xs-12 am-u-sm-6 am-u-md-6 am-u-lg-6 padding-horizontal-lg">
                    <div class="am-form-group">
                        <label>商品一级分类<span class="red">*</span>：</label>
                        <select id="firstSort" required="required" data-am-selected="{searchBox: 1,maxHeight: 200}" name='categoryid'>
                            <option value=''>请选择一个！</option>
                            <?php foreach($cates as $val):?>
                            <option value="<?php echo $val['catid'];?>"><?php echo $val['catname'];?></option>
                            <?php endforeach;?>
                        </select>
                    </div>
                    <div class="am-form-group" id="secondSort" style="display: none;">
                        <label>商品二级分类<span class="red">*</span>：</label>
                        <select id="secondSortSelect" required="required" data-am-selected="{searchBox: 1,maxHeight: 200}" name='soncategoryid'>
                        
                        </select>
                    </div>
                      <!--   <div class="am-form-group"> 
                            <label for="oneType">是否是推荐产品<span class="red">*</span>：</label>
                            <input type="radio" name="recommend" value="1"/>是
                            <input type="radio" name="recommend" value="0"/>否
                        </div> -->
                        
                        <div class="am-form-group">
                            <label for="englishName">商品库存(件)<span class="red">*</span>：</label>
                            <input type="number"  id="respority" name="amount" required="required" />
                        </div>
                     <!--    <?php if($this->session->users['gid'] != 2):?>
                        <div class="am-form-group">
                            <label for="englishName">审核状态：<span class="red">*</span>：</label>
                            <select id="oneType" required="required" name='auditing_state'>
                                <option value="">-=请选择一项=-</option>
                                <option value="1">通过审核</option>
                                <option value="0">待审核</option>
                                <option value="2">未通过</option>
                            </select>

                        </div> 
                        <?php endif;?> -->
                        <div class="am-form-group">
                            <label for="englishName">商品状态：<span class="red">*</span>：</label>
                            <input type="radio" name="goods_state" value="1"/>上架
                            <input type="radio" name="goods_state" value="0"/>下架
                        </div>
                        <div class="am-form-group">
                            <label for="user-weibo" >商品图片：</label>
                            <div class="am-u-sm-12">
                                <div class="am-u-sm-4">
                                    <div class="wx_type_img">
                                     <input type="file" id="imgUpload" name="img1" onchange="previewImage(this)" class="upload-add" multiple="multiple" required>
                                      <!-- 图片实时预览 -->
                                      <div id="preview"> <img style="border-radius: 3px;" src="assets/img/nullImg.jpg" class="am-img-responsive cardView firstBanner"> </div>
                                    </div>
                                    <span class="deleteImg"><i class="am-icon-trash"></i> 删除</span> 
                                </div>
                                <div class="am-u-sm-4">
                                    <div class="wx_type_img">
                                     <input type="file" id="imgUpload" name="img2" onchange="previewImage(this)" class="upload-add" multiple="multiple">
                                      <!-- 图片实时预览 -->
                                      <div id="preview"> <img style="border-radius: 3px;" src="assets/img/nullImg.jpg" class="am-img-responsive cardView"> </div>
                                    </div>
                                    <span class="deleteImg"><i class="am-icon-trash"></i> 删除</span> 
                                </div>
                                <div class="am-u-sm-4">
                                    <div class="wx_type_img">
                                     <input type="file" id="imgUpload" name="img3" onchange="previewImage(this)" class="upload-add" multiple="multiple">
                                      <!-- 图片实时预览 -->
                                      <div id="preview"> <img style="border-radius: 3px;" src="assets/img/nullImg.jpg" class="am-img-responsive cardView"> </div>
                                    </div>
                                    <span class="deleteImg"><i class="am-icon-trash"></i> 删除</span> 
                                </div>
                            </div>
                            <div class="am-text-center father">
                              
                              <small class="tpl-form-line-small-title">提示：图片格式支持：PNG、JPG、JPEG；不超过三张，最大支持2M</small> 
                          </div> 
                        </div>
                        
                    </div>
                    <div class="memberInfo am-u-xs-12 am-u-sm-12 am-u-md-12 am-u-lg-12 padding-horizontal-lg"> 
                        <div class="am-form-group">
                            <label for="englishName">商品信息详情<span class="red">*</span>：</label>
                            <div id="editorContent">
                                <script id="editor" type="text/plain" name='content'></script>
                            </div>                  
                        </div>
                    </div>
                </div>

                    <div class="am-form-group am-text-center">
                        <!-- <a data-am-modal="{target: '#goodMessage'}" id="eyeDetail" class="am-btn am-btn-default am-btn-warning"><span class="am-icon-eye"></span> 点击预览</a>  -->
                        <button class="am-btn am-btn-secondary" type="submit" id='addProperty'>提交</button>
                        <button class="am-btn am-btn-default" type="reset" id="cancle">取消</button> 
                    </div>

                </div>
            </form>
        </div>
    </div>
</div>
</div>
<!-- 预览开始 -->
<div class="am-modal am-modal-prompt" tabindex="-1" id="goodMessage">
    <div class="am-modal-dialog">
        <div class="am-modal-hd">商品详情预览</div>
        <div class="am-modal-bd good-bd">
            <div class="goodBanner">
                <img src="" class="bannerPic" />
            </div>
            <div class="goodBanner am-u-lg-12 am-u-sm-12 am-u-md-12 am-text-left addpadding">
                <div class="am-u-lg-10 am-u-sm-10 am-u-md-10">leica/徕卡 SOFORT相机 一次成像立拍立得相机 限量出售</div>
                <div class="am-u-lg-2 am-u-sm-2 am-u-md-2 am-text-center" style="border-left: 1px solid #ccc;">
                    <img src="assets/img/shangjia.png" class="shoplogo" />
                    <p class="small-word">商家</p>
                </div>
            </div>
            <div class="goodBanner am-u-lg-12 am-u-sm-12 am-u-md-12 am-text-left good-price">
                <div class="am-u-lg-4 am-u-sm-4 am-u-md-4">￥ 2299</div>
            </div>
            <div class="goodBanner am-u-lg-12 am-u-sm-12 am-u-md-12 am-text-left">
                <div class="am-u-lg-4 am-u-sm-4 am-u-md-4 small-word">快递：免邮</div>
                <div class="am-u-lg-4 am-u-sm-4 am-u-md-4 small-word">
                    销量：21笔
                </div>
                <div class="am-u-lg-4 am-u-sm-4 am-u-md-4 small-word">
                    重庆
                </div>
            </div>
            <div class="goodBanner am-u-lg-12 am-u-sm-12 am-u-md-12 am-text-left good-detail">
                <p class="big-word">商品详情</p>
                <article class="smallsize">
                    它融合了徕卡的独特设计专属功能，令我们重新发现即影即有的摄影世界，创造出可以触摸到的小小艺术品。
                </article>
            </div>
        </div>
        <div class="am-modal-footer">
            <span class="am-modal-btn" data-am-modal-cancle>取消</span>
            <span class="am-modal-btn" data-am-modal-confirm>确定</span>
        </div>
    </div>
</div>
<!-- 预览结束 -->
<!-- 设置运费弹出框开始 -->
<div class="am-modal am-modal-prompt" tabindex="-1" id="myModal">
    <div class="am-modal-dialog">
        <div class="am-modal-hd">请输入运费</div>
        <div class="am-modal-bd">
            <input type="number" class="am-modal-prompt-input" name="" required>
        </div>
        <div class="am-modal-footer">
            <span class="am-modal-btn" data-am-modal-cancle>取消</span>
            <span class="am-modal-btn" data-am-modal-confirm>确定</span>
        </div>
    </div>
</div>
<div class="goTop"><a href="javascript:scroll(0,0)" type="button"><img src="assets/img/top.png" alt="点我回到顶部"></a></div>
<!-- 设置运费弹出框结束 -->
<script type="text/javascript" charset="utf-8" src="assets/ueditor/ueditor.config.js"></script>
    <script type="text/javascript" charset="utf-8" src="assets/ueditor/ueditor.all.min.js"> </script>
    <!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
    <!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
    <script type="text/javascript" charset="utf-8" src="assets/ueditor/lang/zh-cn/zh-cn.js"></script>
</body>
<script type="text/javascript">
  $(function() {
    var startDate = new Date(2014, 11, 20);
    var endDate = new Date(2014, 11, 25);
    var $alert = $('#my-alert');
    $('#my-start').datepicker().
      on('changeDate.datepicker.amui', function(event) {
        if (event.date.valueOf() > endDate.valueOf()) {
          $alert.find('p').text('开始日期应小于结束日期！').end().show();
        } else {
          $alert.hide();
          startDate = new Date(event.date);
          $('#my-startDate').text($('#my-start').data('date'));
        }
        $(this).datepicker('close');
      });

    $('#my-end').datepicker().
      on('changeDate.datepicker.amui', function(event) {
        if (event.date.valueOf() < startDate.valueOf()) {
          $alert.find('p').text('结束日期应大于开始日期！').end().show();
        } else {
          $alert.hide();
          endDate = new Date(event.date);
          $('#my-endDate').text($('#my-end').data('date'));
        }
        $(this).datepicker('close');
      });

      //点击预览商品详情
      $('#eyeDetail').click(function() {
        var picSrc=$('.firstBanner').attr("src");
        var goodName=$('#goodName').val();
        var goodPrice=$('#goodPrice').val();
        var postage=$('#postage').attr('checked');
        var dispostage=$('#dispostage').attr('checked');
        var editorContent=$('#editorContent').html(); 
        console.log(editorContent);
        $(".bannerPic").attr('src',picSrc);
      })
      
  });
//点击取消返回上一页
  $('#cancle').click(function(){
    history.go(-1);
  });

  //点击进行运费设置
$('#postage').click(function(){
    $('.postageNumber').css('display','block');

});
//点击取消运费设置
$('#dispostage').click(function(){
    $('.postageNumber').css('display','none');
});

 //删除图片
$(".deleteImg").click(function(){
    $(this).siblings('.wx_type_img').find('img').attr('src','assets/img/nullImg.jpg');
    $(this).siblings('.wx_type_img').find('input').val("");
    $(this).siblings('.wx_type_img').find('input').files="";
});
var i=1;
  
//实例化编辑器
  var ue = UE.getEditor('editor');

 //添加属性名称的设置
    $('.createMoreName').click(function(){   
        i++;
        $('<table class="addProperty"><thead><th>属性名称</th><th>&nbsp;</th></thead><tbody class="addPropertyBody"><td class="propertyName"><input type="text" ></td><td>&nbsp;</i></td><table class="addPropertyContent"><thead><th>属性值</th><th>附加值</th><th>&nbsp;</th></thead><tbody class="addPropertyTr"><tr class="addPropertytr"><td class="propertyValue"><input type="text" ></td><td class="propertyValue"><input type="text" ></td><td class="propertyValue"><input type="text" ></td><td class="propertyValue"><i class="am-icon am-icon-plus addStyle createMore'+ i +'"></i></td></tr></tbody></table></tbody></table>').appendTo('.tableContainer');
        //添加属性值的设置

        $('.createMore'+i).click(function(){
           $('<tr class="addPropertytr"><td><input type="text" ></td><td><input type="text" ></td><td><input type="text" ></td></tr>').appendTo(this.parentNode.parentNode.parentNode);
        });    
    })
    //添加属性值的设置
    $('.createMore1').click(function(){
       $('<tr class="addPropertytr"><td><input type="text" ></td><td><input type="text" ></td><td><input type="text" ></td></tr>').appendTo(this.parentNode.parentNode.parentNode);
    });

    //添加属性
    $('#addProperty').click(function(){
        var propertyArray=[];
        for(var i=0;i<$('.addPropertyBody').length;i++){
            var arrayPropertyName={},addPropertyBody={};
            var parameter_name=$('.addPropertyBody').eq(i).find('input').val();
            arrayPropertyName.parameter_name=parameter_name;    
            arrayPropertyName.child_value=[];
            var addPropertytr=$('.addPropertyContent').eq(i).find('.addPropertytr')
            for(var j=0;j<addPropertytr.length;j++){
                var td=addPropertytr.eq(j).find('td');
                var addPropertytd={};
                addPropertytd.parameter_name=parameter_name;
                addPropertytd.child_parameter_name=td.eq('0').find('input').val();
                addPropertytd.equivalence=td.eq('1').find('input').val();
                addPropertytd.Inventory=td.eq('2').find('input').val();
                arrayPropertyName.child_value.push(addPropertytd);
            }
            propertyArray.push(arrayPropertyName);
        }
        $("#inputproperty").val(JSON.stringify(propertyArray));
       console.log(JSON.stringify(propertyArray));
    });

    $(document).ready(function(){
        //根据一级业态的内容来控制二级业态的显示
        var firstSort=$('#firstSort option:selected').val(),str='',sttr='<option value="">请选择一项...</option>';
        $.ajax({
            type:'post',
            url:'<?php echo site_url('shop/SingleShop/return_godos_cate');?>',
            data: 'catid='+ firstSort,
            success: function(data){   
                var jsonData=eval(data);
                console.log(jsonData);
                if(data){                   
                    for(var i=0;i<jsonData.length;i++){
                        str='<option value="'+ jsonData[i].catid +'">' + jsonData[i].catname + '</option>';
                        sttr=sttr+str;
                    }
                    console.log(sttr);
                    $('#secondSort').css('display','block');
                    $("#secondSortSelect").append(sttr);
                }else{
                    alert("操作失败，请检查网络设置！");
                }
                
            },
            error:function(xhr,type,errorThrown){
                alert("操作失败，请检查网络设置！");
            }
        });


         $('#firstSort').change(function(){
            //根据一级业态的内容来控制二级业态的显示
            var firstSort=$('#firstSort option:selected').val(),str='',sttr='<option value="">请选择一项...</option>';
            $.ajax({
                type:'post',
                url:'<?php echo site_url('shop/SingleShop/return_godos_cate');?>',
                data: 'catid='+ firstSort,
                success: function(data){ 
                    $("#secondSortSelect").html("");  
                    var jsonData=eval(data);
                    console.log(jsonData);
                    if(data){                
                        for(var i=0;i<jsonData.length;i++){
                            str='<option value="'+ jsonData[i].catid +'">' + jsonData[i].catname + '</option>';
                            sttr=sttr+str;
                        }
                        console.log(sttr);
                        $('#secondSort').css('display','block');
                        $("#secondSortSelect").append(sttr);
                    }else{
                        alert("操作失败，请检查网络设置！");
                    }
                    
                },
                error:function(xhr,type,errorThrown){
                    alert("操作失败，请检查网络设置！");
                }
            });
        });
    });
</script>
